# ç”µå­ç›¸å†Œ - Photo Gallery

ä¸€ä¸ªç®€å•è€Œç¾è§‚çš„ç”µå­ç›¸å†ŒWebåº”ç”¨ï¼Œæ”¯æŒç…§ç‰‡ä¸Šä¼ ã€æµè§ˆå’Œç®¡ç†ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ¨ å…¨å±æ²‰æµ¸å¼ç”»å»Š
- **å…¨å±å±•ç¤º** - æ¯æ¬¡åªå±•ç¤ºä¸€å¼ ç…§ç‰‡ï¼Œè‡ªé€‚åº”å±å¹•å¤§å°
- **æç®€è®¾è®¡** - çº¯å‡€çš„è§†è§‰ä½“éªŒï¼Œä¸“æ³¨äºç…§ç‰‡æœ¬èº«
- **å¤šç§å¯¼èˆª** - æ”¯æŒå·¦å³ç®­å¤´ã€é”®ç›˜æ–¹å‘é”®ã€é¼ æ ‡æ»šè½®ã€è§¦æ‘¸æ»‘åŠ¨
- **æ™ºèƒ½è®¡æ•°** - åº•éƒ¨æ˜¾ç¤ºå½“å‰ç…§ç‰‡ä½ç½®ï¼ˆå¦‚ 3/10ï¼‰

### ğŸ“¤ ä¾¿æ·ä¸Šä¼ 
- **æ‹–æ‹½ä¸Šä¼ ** - æ”¯æŒæ‹–æ‹½æ–‡ä»¶åˆ°ä¸Šä¼ åŒºåŸŸ
- **å›¾ç‰‡é¢„è§ˆ** - ä¸Šä¼ å‰å®æ—¶é¢„è§ˆç…§ç‰‡
- **å¿«é€Ÿæ“ä½œ** - ä¸Šä¼ æˆåŠŸåè‡ªåŠ¨è·³è½¬åˆ°ç”»å»Š

### ğŸ–¼ï¸ å¼ºå¤§çš„æµè§ˆåŠŸèƒ½
- **å·¦å³ç®­å¤´** - ç‚¹å‡»å±å¹•ä¸¤ä¾§ç®­å¤´åˆ‡æ¢ç…§ç‰‡
- **é”®ç›˜æ§åˆ¶** - â† â†’ æ–¹å‘é”®ç¿»é¡µï¼Œç©ºæ ¼é”®è‡ªåŠ¨æ’­æ”¾
- **é¼ æ ‡æ»šè½®** - æ»šè½®ä¸Šä¸‹æ»šåŠ¨åˆ‡æ¢ç…§ç‰‡
- **è§¦æ‘¸æ»‘åŠ¨** - ç§»åŠ¨ç«¯å·¦å³æ»‘åŠ¨æµè§ˆ
- **è‡ªåŠ¨æ’­æ”¾** - æ”¯æŒè‡ªåŠ¨æ’­æ”¾æ¨¡å¼ï¼ˆ3ç§’/å¼ ï¼‰

### ğŸ¯ å…¶ä»–ç‰¹æ€§
- ğŸ—‘ï¸ **å¿«é€Ÿåˆ é™¤** - åº•éƒ¨åˆ é™¤æŒ‰é’®ï¼Œè½»æ¾ç®¡ç†ç…§ç‰‡
- ğŸ“± **å“åº”å¼è®¾è®¡** - å®Œç¾é€‚é…æ¡Œé¢ã€å¹³æ¿å’Œæ‰‹æœº
- ğŸ­ **é»‘è‰²èƒŒæ™¯** - çªå‡ºç…§ç‰‡ï¼Œå‡å°‘è§†è§‰å¹²æ‰°
- âš¡ **æµç•…åŠ¨ç”»** - ç…§ç‰‡åˆ‡æ¢æ—¶çš„æ·¡å…¥æ·¡å‡ºæ•ˆæœ
- ğŸ® **å¤šç§æ“ä½œ** - æ”¯æŒç‚¹å‡»ã€é”®ç›˜ã€æ»šè½®ã€è§¦æ‘¸ç­‰å¤šç§äº¤äº’

## æŠ€æœ¯æ ˆ

- **åç«¯**: Flask (Python)
- **å‰ç«¯**: HTML5, CSS3, JavaScript (åŸç”Ÿ)
- **å­˜å‚¨**: æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ + JSONå…ƒæ•°æ®

## ç³»ç»Ÿè¦æ±‚

- **Python 2.7** æˆ– Python 3.7+ï¼ˆå·²é€‚é… Python 2ï¼‰
- Linux æ“ä½œç³»ç»Ÿï¼ˆæ¨è Ubuntu/Debian/CentOSï¼‰

> **æ³¨æ„**ï¼šæœ¬é¡¹ç›®ç°å·²å®Œå…¨æ”¯æŒ Python 2.7 + Flask 1.1.4ï¼Œå¯ç›´æ¥åœ¨ CentOS 7 ç­‰ç³»ç»Ÿä¸Šä½¿ç”¨ã€‚

## å¿«é€Ÿéƒ¨ç½²

### ğŸš€ Python 2 ç”¨æˆ·ï¼ˆCentOS 7 ç­‰ï¼‰

å¦‚æœä½ ä½¿ç”¨ Python 2.7ï¼Œè¯·ä½¿ç”¨ä¸“é—¨çš„ä¿®å¤è„šæœ¬ï¼š

```bash
cd /data/home/webs/webphoto/website
chmod +x fix_service_py2.sh
./fix_service_py2.sh
```

**è¯¦ç»†è¯´æ˜**ï¼šæŸ¥çœ‹ [INSTALL_GUIDE.md](INSTALL_GUIDE.md) æˆ– [QUICK_FIX.md](QUICK_FIX.md)

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆPython 3ï¼‰

1. å…‹éš†æˆ–ä¸Šä¼ é¡¹ç›®æ–‡ä»¶åˆ°æœåŠ¡å™¨
2. è¿è¡Œéƒ¨ç½²è„šæœ¬ï¼š

```bash
chmod +x deploy.sh
sudo ./deploy.sh
```

3. è®¿é—® `http://æœåŠ¡å™¨IP:5000`

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

#### 1. å®‰è£…ä¾èµ–

**Python 3 (æ¨è):**
```bash
# å®‰è£… Python3 å’Œ pip
sudo apt update
sudo apt install python3 python3-pip python3-venv -y

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£… Python ä¾èµ–
pip install -r requirements.txt
```

**Python 2 (CentOS 7 ç­‰):**
```bash
# å®‰è£… Python2 å’Œ virtualenv
sudo yum install -y python python-pip python-virtualenv

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
virtualenv venv
source venv/bin/activate

# å‡çº§ pip
pip install --upgrade "pip<21.0"

# å®‰è£…ä¾èµ–
pip install Flask==1.1.4 Werkzeug==1.0.1 gunicorn
```

#### 2. åˆ›å»ºå¿…è¦çš„ç›®å½•

```bash
mkdir -p uploads
```

#### 3. è¿è¡Œåº”ç”¨

```bash
# å¼€å‘æ¨¡å¼
python app.py

# ç”Ÿäº§æ¨¡å¼ï¼ˆä½¿ç”¨ gunicornï¼‰
pip install gunicorn
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

#### 4. é…ç½®ä¸ºç³»ç»ŸæœåŠ¡ï¼ˆå¯é€‰ï¼‰

```bash
# å¤åˆ¶æœåŠ¡æ–‡ä»¶
sudo cp photo-gallery.service /etc/systemd/system/

# ä¿®æ”¹æœåŠ¡æ–‡ä»¶ä¸­çš„è·¯å¾„
sudo nano /etc/systemd/system/photo-gallery.service
# å°† /path/to/photo-gallery æ›¿æ¢ä¸ºå®é™…è·¯å¾„

# å¯åŠ¨æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl enable photo-gallery
sudo systemctl start photo-gallery

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status photo-gallery
```

## é…ç½®è¯´æ˜

### åº”ç”¨é…ç½®

åœ¨ `config.py` ä¸­å¯ä»¥ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š

- `UPLOAD_FOLDER`: ç…§ç‰‡ä¸Šä¼ ç›®å½•ï¼ˆé»˜è®¤: uploadsï¼‰
- `ALLOWED_EXTENSIONS`: å…è®¸çš„æ–‡ä»¶æ ¼å¼ï¼ˆé»˜è®¤: png, jpg, jpeg, gif, webpï¼‰
- `MAX_FILE_SIZE`: æœ€å¤§æ–‡ä»¶å¤§å°ï¼ˆé»˜è®¤: 16MBï¼‰
- `HOST`: ç›‘å¬åœ°å€ï¼ˆé»˜è®¤: 0.0.0.0ï¼‰
- `PORT`: ç«¯å£å·ï¼ˆé»˜è®¤: 5000ï¼‰
- `DEBUG`: è°ƒè¯•æ¨¡å¼ï¼ˆé»˜è®¤: Falseï¼‰

ä½ ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®æŸäº›é…ç½®ï¼š

```bash
export SECRET_KEY="your-secret-key"
```

### é˜²ç«å¢™é…ç½®

å¦‚æœæ— æ³•è®¿é—®ï¼Œéœ€è¦å¼€æ”¾ç«¯å£ï¼š

```bash
# UFW é˜²ç«å¢™
sudo ufw allow 5000/tcp

# firewalld
sudo firewall-cmd --permanent --add-port=5000/tcp
sudo firewall-cmd --reload
```

## ä½¿ç”¨ Nginx åå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰

å¦‚æœè¦ä½¿ç”¨ 80 ç«¯å£è®¿é—®ï¼Œå¯ä»¥é…ç½® Nginxï¼š

```bash
sudo apt install nginx -y
```

åˆ›å»ºé…ç½®æ–‡ä»¶ `/etc/nginx/sites-available/photo-gallery`:

```nginx
server {
    listen 80;
    server_name your_domain.com;  # æ›¿æ¢ä¸ºä½ çš„åŸŸåæˆ–IP

    client_max_body_size 20M;

    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

å¯ç”¨é…ç½®ï¼š

```bash
sudo ln -s /etc/nginx/sites-available/photo-gallery /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

## æµ‹è¯•

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯åº”ç”¨åŠŸèƒ½ï¼š

```bash
source venv/bin/activate
python test_app.py
```

## ğŸ›ï¸ æœåŠ¡ç®¡ç†

### ä½¿ç”¨ç®¡ç†è„šæœ¬ï¼ˆæ¨èï¼‰

é¡¹ç›®æä¾›äº†ä¸°å¯Œçš„ç®¡ç†è„šæœ¬ï¼Œè®©æœåŠ¡ç®¡ç†å˜å¾—ç®€å•ï¼š

```bash
# ç»™è„šæœ¬æ‰§è¡Œæƒé™ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰
chmod +x *.sh

# ç»¼åˆç®¡ç†å·¥å…·ï¼ˆæ¨èï¼‰
./manage.sh

# æˆ–ä½¿ç”¨ç‹¬ç«‹è„šæœ¬
./start_service.sh    # å¯åŠ¨æœåŠ¡
./stop.sh             # åœæ­¢æœåŠ¡
./restart_service.sh  # é‡å¯æœåŠ¡
./status.sh           # æŸ¥çœ‹çŠ¶æ€
./logs.sh             # æŸ¥çœ‹æ—¥å¿—
```

### ä½¿ç”¨ systemctl å‘½ä»¤

```bash
# å¯åŠ¨æœåŠ¡
sudo systemctl start photo-gallery

# åœæ­¢æœåŠ¡
sudo systemctl stop photo-gallery

# é‡å¯æœåŠ¡
sudo systemctl restart photo-gallery

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status photo-gallery

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u photo-gallery -f

# å¤‡ä»½æ•°æ®
tar -czf photo-gallery-backup-$(date +%Y%m%d).tar.gz uploads/ metadata.json
```

è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ [SCRIPTS_GUIDE.md](SCRIPTS_GUIDE.md)

## ç›®å½•ç»“æ„

```
photo-gallery/
â”œâ”€â”€ app.py                    # Flask åº”ç”¨ä¸»æ–‡ä»¶
â”œâ”€â”€ config.py                 # é…ç½®æ–‡ä»¶
â”œâ”€â”€ test_app.py              # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ requirements.txt          # Python ä¾èµ–
â”œâ”€â”€ metadata.json            # ç…§ç‰‡å…ƒæ•°æ®ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html           # HTML æ¨¡æ¿
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ style.css            # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ script.js            # JavaScript æ–‡ä»¶
â”œâ”€â”€ uploads/                 # ç…§ç‰‡å­˜å‚¨ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ deploy.sh                # è‡ªåŠ¨éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ start.sh                 # å¿«é€Ÿå¯åŠ¨è„šæœ¬ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
â”œâ”€â”€ photo-gallery.service    # Systemd æœåŠ¡æ–‡ä»¶
â”œâ”€â”€ nginx.conf.example       # Nginx é…ç½®ç¤ºä¾‹
â”œâ”€â”€ .gitignore              # Git å¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md                # è¯´æ˜æ–‡æ¡£
```

## å¸¸è§é—®é¢˜

### 1. ä¸Šä¼ å¤±è´¥

- æ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦è¶…è¿‡é™åˆ¶ï¼ˆé»˜è®¤16MBï¼‰
- æ£€æŸ¥æ–‡ä»¶æ ¼å¼æ˜¯å¦æ”¯æŒ
- æ£€æŸ¥ uploads ç›®å½•æƒé™

### 2. æ— æ³•è®¿é—®

- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- ç¡®è®¤æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨

### 3. æƒé™é—®é¢˜

```bash
# ç¡®ä¿ç›®å½•æœ‰æ­£ç¡®çš„æƒé™
chmod 755 uploads
chown -R $USER:$USER .
```

## å®‰å…¨å»ºè®®

1. **ç”Ÿäº§ç¯å¢ƒå»ºè®®**:
   - ä½¿ç”¨ HTTPSï¼ˆé…ç½® SSL è¯ä¹¦ï¼‰
   - æ·»åŠ ç”¨æˆ·è®¤è¯
   - é™åˆ¶ä¸Šä¼ æ–‡ä»¶å¤§å°å’Œé¢‘ç‡
   - å®šæœŸå¤‡ä»½ uploads ç›®å½•å’Œ metadata.json

2. **é˜²ç«å¢™**:
   - åªå¼€æ”¾å¿…è¦çš„ç«¯å£
   - ä½¿ç”¨ Nginx åå‘ä»£ç†è€Œä¸æ˜¯ç›´æ¥æš´éœ² Flask

3. **æ–‡ä»¶å®‰å…¨**:
   - å®šæœŸæ£€æŸ¥ä¸Šä¼ çš„æ–‡ä»¶
   - è€ƒè™‘æ·»åŠ å›¾ç‰‡æ ¼å¼éªŒè¯

## ğŸ“– æ–‡æ¡£

### ç”¨æˆ·æ–‡æ¡£
- **[README.md](README.md)** - é¡¹ç›®è¯´æ˜å’Œéƒ¨ç½²æŒ‡å—ï¼ˆæœ¬æ–‡ä»¶ï¼‰
- **[USER_GUIDE.md](USER_GUIDE.md)** - ç”¨æˆ·ä½¿ç”¨æŒ‡å—
- **[QUICKSTART.md](QUICKSTART.md)** - å¿«é€Ÿå¼€å§‹æŒ‡å—
- **[QUICK_REFERENCE.md](QUICK_REFERENCE.md)** - å¿«é€Ÿå‚è€ƒå¡ç‰‡ âš¡

### åŠŸèƒ½æ–‡æ¡£
- **[FEATURES_3D.md](FEATURES_3D.md)** - 3D ç”»å»ŠåŠŸèƒ½è¯¦è§£
- **[DEMO.md](DEMO.md)** - åŠŸèƒ½æ¼”ç¤ºè¯´æ˜
- **[CHANGELOG.md](CHANGELOG.md)** - ç‰ˆæœ¬æ›´æ–°æ—¥å¿—

### éƒ¨ç½²æ–‡æ¡£
- **[INSTALL_GUIDE.md](INSTALL_GUIDE.md)** - è¯¦ç»†å®‰è£…æŒ‡å—ï¼ˆPython 2ï¼‰
- **[DEPLOYMENT_CHECKLIST.md](DEPLOYMENT_CHECKLIST.md)** - éƒ¨ç½²æ£€æŸ¥æ¸…å•
- **[QUICK_FIX.md](QUICK_FIX.md)** - å¿«é€Ÿä¿®å¤æŒ‡å—

### ç®¡ç†æ–‡æ¡£
- **[SCRIPTS_GUIDE.md](SCRIPTS_GUIDE.md)** - è„šæœ¬ä½¿ç”¨æŒ‡å— ğŸ›ï¸
- **[README_PY2.md](README_PY2.md)** - Python 2 ä¸“ç”¨è¯´æ˜

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åé¦ˆã€‚

---

**äº«å—ä½¿ç”¨ç”µå­ç›¸å†Œï¼** ğŸ“·âœ¨

