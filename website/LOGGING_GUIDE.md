# ğŸ“ æ—¥å¿—ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸ“– æ¦‚è¿°

åº”ç”¨å·²é›†æˆå®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿï¼Œè‡ªåŠ¨è®°å½•æ‰€æœ‰æ“ä½œå’Œé”™è¯¯ä¿¡æ¯ã€‚

## ğŸ“ æ—¥å¿—æ–‡ä»¶ç»“æ„

```
logs/
â”œâ”€â”€ app.log              # å½“å‰åº”ç”¨æ—¥å¿—
â”œâ”€â”€ app.log.2025-12-26   # å†å²åº”ç”¨æ—¥å¿—ï¼ˆæŒ‰æ—¥æœŸï¼‰
â”œâ”€â”€ error.log            # å½“å‰é”™è¯¯æ—¥å¿—
â””â”€â”€ error.log.2025-12-26 # å†å²é”™è¯¯æ—¥å¿—ï¼ˆæŒ‰æ—¥æœŸï¼‰
```

### æ—¥å¿—ç±»å‹

1. **app.log** - åº”ç”¨æ—¥å¿—
   - æ‰€æœ‰ API è¯·æ±‚
   - æ–‡ä»¶ä¸Šä¼ /åˆ é™¤æ“ä½œ
   - ç³»ç»Ÿä¿¡æ¯
   - æ­£å¸¸è¿è¡Œæ—¥å¿—

2. **error.log** - é”™è¯¯æ—¥å¿—
   - å¼‚å¸¸é”™è¯¯
   - å¤±è´¥æ“ä½œ
   - å †æ ˆè·Ÿè¸ª

## ğŸ” æŸ¥çœ‹æ—¥å¿—

### æ–¹æ³• 1: ä½¿ç”¨æ—¥å¿—æŸ¥çœ‹è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
./view_logs.sh
```

é€‰é¡¹ï¼š
1. ä»Šå¤©çš„åº”ç”¨æ—¥å¿—
2. ä»Šå¤©çš„é”™è¯¯æ—¥å¿—
3. æ‰€æœ‰åº”ç”¨æ—¥å¿—
4. æ‰€æœ‰é”™è¯¯æ—¥å¿—
5. å®æ—¶ç›‘æ§åº”ç”¨æ—¥å¿—
6. å®æ—¶ç›‘æ§é”™è¯¯æ—¥å¿—
7. åˆ—å‡ºæ‰€æœ‰æ—¥å¿—æ–‡ä»¶

### æ–¹æ³• 2: ç›´æ¥æŸ¥çœ‹æ–‡ä»¶

```bash
# æŸ¥çœ‹ä»Šå¤©çš„åº”ç”¨æ—¥å¿—
cat logs/app.log

# æŸ¥çœ‹ä»Šå¤©çš„é”™è¯¯æ—¥å¿—
cat logs/error.log

# å®æ—¶ç›‘æ§
tail -f logs/app.log

# æŸ¥çœ‹æœ€è¿‘ 50 è¡Œ
tail -n 50 logs/app.log

# æœç´¢ç‰¹å®šå†…å®¹
grep "é”™è¯¯" logs/app.log
grep "ä¸Šä¼ " logs/app.log
```

### æ–¹æ³• 3: ä½¿ç”¨ less åˆ†é¡µæŸ¥çœ‹

```bash
# åˆ†é¡µæŸ¥çœ‹ï¼ˆå¯æœç´¢ï¼‰
less logs/app.log

# åœ¨ less ä¸­ï¼š
# ç©ºæ ¼ - ä¸‹ä¸€é¡µ
# b - ä¸Šä¸€é¡µ
# /å…³é”®è¯ - æœç´¢
# q - é€€å‡º
```

## ğŸ“Š æ—¥å¿—æ ¼å¼

```
[2025-12-26 14:30:15] INFO: API: è¯·æ±‚ç…§ç‰‡åˆ—è¡¨
[2025-12-26 14:30:15] INFO: åŠ è½½å…ƒæ•°æ®: 5 å¼ ç…§ç‰‡
[2025-12-26 14:30:15] INFO: API: è¿”å› 5 å¼ ç…§ç‰‡
[2025-12-26 14:30:20] ERROR: ä¸Šä¼ å¤±è´¥: æ–‡ä»¶å¤ªå¤§
```

æ ¼å¼è¯´æ˜ï¼š
- `[æ—¥æœŸæ—¶é—´]` - æ—¶é—´æˆ³
- `çº§åˆ«` - INFO/ERROR/WARNING
- `æ¶ˆæ¯` - å…·ä½“å†…å®¹

## ğŸ” å¸¸è§æ—¥å¿—æŸ¥è¯¢

### 1. æŸ¥æ‰¾é”™è¯¯

```bash
# æŸ¥æ‰¾æ‰€æœ‰é”™è¯¯
grep "ERROR" logs/app.log

# æŸ¥æ‰¾ä»Šå¤©çš„é”™è¯¯
grep "$(date +%Y-%m-%d)" logs/error.log

# æŸ¥æ‰¾ç‰¹å®šé”™è¯¯
grep "ä¸Šä¼ å¤±è´¥" logs/error.log
```

### 2. ç»Ÿè®¡ä¿¡æ¯

```bash
# ç»Ÿè®¡ä»Šå¤©çš„è¯·æ±‚æ•°
grep "$(date +%Y-%m-%d)" logs/app.log | wc -l

# ç»Ÿè®¡é”™è¯¯æ•°
grep "ERROR" logs/app.log | wc -l

# ç»Ÿè®¡ä¸Šä¼ æ¬¡æ•°
grep "ä¸Šä¼ æˆåŠŸ" logs/app.log | wc -l

# ç»Ÿè®¡åˆ é™¤æ¬¡æ•°
grep "åˆ é™¤æˆåŠŸ" logs/app.log | wc -l
```

### 3. æŒ‰æ—¶é—´æŸ¥è¯¢

```bash
# æŸ¥çœ‹ä»Šå¤© 14 ç‚¹çš„æ—¥å¿—
grep "2025-12-26 14:" logs/app.log

# æŸ¥çœ‹æœ€è¿‘ 1 å°æ—¶
tail -n 1000 logs/app.log | grep "$(date +%Y-%m-%d\ %H:)"
```

### 4. æŸ¥çœ‹ç‰¹å®šæ“ä½œ

```bash
# ä¸Šä¼ æ“ä½œ
grep "ä¸Šä¼ " logs/app.log

# åˆ é™¤æ“ä½œ
grep "åˆ é™¤" logs/app.log

# API è¯·æ±‚
grep "API:" logs/app.log

# è®¿é—®ä¸»é¡µ
grep "è®¿é—®ä¸»é¡µ" logs/app.log
```

## ğŸ› ï¸ æ—¥å¿—ç®¡ç†

### æŸ¥çœ‹æ—¥å¿—å¤§å°

```bash
du -sh logs/
ls -lh logs/
```

### æ¸…ç†æ—§æ—¥å¿—

```bash
# åˆ é™¤ 30 å¤©å‰çš„æ—¥å¿—
find logs/ -name '*.log.*' -mtime +30 -delete

# åˆ é™¤ 7 å¤©å‰çš„æ—¥å¿—
find logs/ -name '*.log.*' -mtime +7 -delete

# æ‰‹åŠ¨åˆ é™¤ç‰¹å®šæ—¥å¿—
rm logs/app.log.2025-12-01
```

### å¤‡ä»½æ—¥å¿—

```bash
# å¤‡ä»½æ‰€æœ‰æ—¥å¿—
tar -czf logs-backup-$(date +%Y%m%d).tar.gz logs/

# å¤‡ä»½åˆ°æŒ‡å®šä½ç½®
cp -r logs/ /backup/photo-gallery-logs-$(date +%Y%m%d)/
```

## ğŸ“ˆ æ—¥å¿—è½®è½¬

æ—¥å¿—è‡ªåŠ¨æŒ‰æ—¥æœŸè½®è½¬ï¼š
- **æ—¶é—´**: æ¯å¤©åˆå¤œ
- **ä¿ç•™**: 30 å¤©
- **å‘½å**: `app.log.YYYY-MM-DD`

é…ç½®åœ¨ `app.py` ä¸­ï¼š

```python
file_handler = TimedRotatingFileHandler(
    os.path.join(LOG_FOLDER, 'app.log'),
    when='midnight',      # åˆå¤œè½®è½¬
    interval=1,           # æ¯å¤©
    backupCount=30        # ä¿ç•™ 30 å¤©
)
```

## ğŸ”§ è°ƒè¯•æŠ€å·§

### 1. å®æ—¶ç›‘æ§é—®é¢˜

```bash
# åŒæ—¶ç›‘æ§åº”ç”¨æ—¥å¿—å’Œé”™è¯¯æ—¥å¿—
tail -f logs/app.log logs/error.log

# åªçœ‹é”™è¯¯
tail -f logs/error.log
```

### 2. åˆ†æé—®é¢˜

```bash
# æ‰¾åˆ°é”™è¯¯å‘ç”Ÿçš„æ—¶é—´ç‚¹
grep "ERROR" logs/error.log | tail -n 1

# æŸ¥çœ‹é”™è¯¯å‰åçš„æ—¥å¿—
grep -C 5 "é”™è¯¯ä¿¡æ¯" logs/app.log
# -C 5 è¡¨ç¤ºæ˜¾ç¤ºå‰åå„ 5 è¡Œ
```

### 3. æ€§èƒ½åˆ†æ

```bash
# æŸ¥çœ‹è®¿é—®é¢‘ç‡
grep "è®¿é—®ä¸»é¡µ" logs/app.log | wc -l

# æŸ¥çœ‹ API è°ƒç”¨
grep "API:" logs/app.log

# æŒ‰å°æ—¶ç»Ÿè®¡è®¿é—®
grep "$(date +%Y-%m-%d)" logs/app.log | cut -d' ' -f2 | cut -d':' -f1 | sort | uniq -c
```

## ğŸš¨ å¸¸è§é”™è¯¯å’Œè§£å†³

### 1. "åŠ è½½å…ƒæ•°æ®å¤±è´¥"

**åŸå› **: metadata.json æ–‡ä»¶æŸå

**æŸ¥çœ‹æ—¥å¿—**:
```bash
grep "åŠ è½½å…ƒæ•°æ®" logs/error.log
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å¤‡ä»½å¹¶é‡å»º
cp metadata.json metadata.json.bak
echo '[]' > metadata.json
```

### 2. "æ–‡ä»¶ä¸å­˜åœ¨"

**åŸå› **: ç…§ç‰‡æ–‡ä»¶è¢«åˆ é™¤ä½†å…ƒæ•°æ®æœªæ›´æ–°

**æŸ¥çœ‹æ—¥å¿—**:
```bash
grep "æ–‡ä»¶ä¸å­˜åœ¨" logs/error.log
```

**è§£å†³æ–¹æ¡ˆ**: é‡æ–°åŒæ­¥å…ƒæ•°æ®

### 3. "ä¸Šä¼ å¤±è´¥"

**åŸå› **: å¤šç§å¯èƒ½

**æŸ¥çœ‹è¯¦ç»†é”™è¯¯**:
```bash
grep "ä¸Šä¼ å¤±è´¥" logs/error.log -A 5
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å®šæœŸæ£€æŸ¥æ—¥å¿—

```bash
# æ¯å¤©æ£€æŸ¥é”™è¯¯æ—¥å¿—
./view_logs.sh
# é€‰æ‹© 2) ä»Šå¤©çš„é”™è¯¯æ—¥å¿—
```

### 2. ç›‘æ§ç£ç›˜ç©ºé—´

```bash
# æ£€æŸ¥æ—¥å¿—å ç”¨
du -sh logs/

# å¦‚æœå¤ªå¤§ï¼Œæ¸…ç†æ—§æ—¥å¿—
find logs/ -name '*.log.*' -mtime +15 -delete
```

### 3. å®šæœŸå¤‡ä»½

```bash
# æ¯å‘¨å¤‡ä»½ä¸€æ¬¡
tar -czf logs-backup-$(date +%Y%m%d).tar.gz logs/
```

### 4. é›†æˆåˆ°ç›‘æ§

```bash
# æ·»åŠ åˆ° crontab å®šæ—¶æ£€æŸ¥
crontab -e

# æ¯å°æ—¶æ£€æŸ¥é”™è¯¯
0 * * * * grep "ERROR" /path/to/logs/error.log | tail -n 10 | mail -s "Photo Gallery Errors" admin@example.com
```

## ğŸ“ è°ƒè¯•æ¸…å•

é‡åˆ°é—®é¢˜æ—¶ï¼ŒæŒ‰é¡ºåºæ£€æŸ¥ï¼š

1. **æŸ¥çœ‹é”™è¯¯æ—¥å¿—**
   ```bash
   tail -n 50 logs/error.log
   ```

2. **æŸ¥çœ‹æœ€è¿‘çš„åº”ç”¨æ—¥å¿—**
   ```bash
   tail -n 100 logs/app.log
   ```

3. **æŸ¥æ‰¾ç‰¹å®šé”™è¯¯**
   ```bash
   grep "é”™è¯¯å…³é”®è¯" logs/app.log
   ```

4. **æŸ¥çœ‹å®Œæ•´å †æ ˆ**
   ```bash
   grep -A 10 "ERROR" logs/error.log
   ```

5. **æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—**
   ```bash
   sudo journalctl -u photo-gallery -n 50
   ```

## ğŸ¯ æ—¥å¿—çº§åˆ«

åº”ç”¨ä½¿ç”¨çš„æ—¥å¿—çº§åˆ«ï¼š

- **INFO**: æ­£å¸¸æ“ä½œï¼ˆAPI è°ƒç”¨ã€æ–‡ä»¶æ“ä½œï¼‰
- **WARNING**: è­¦å‘Šä¿¡æ¯ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨ã€æƒé™é—®é¢˜ï¼‰
- **ERROR**: é”™è¯¯ä¿¡æ¯ï¼ˆå¼‚å¸¸ã€å¤±è´¥æ“ä½œï¼‰

## ğŸ“ ç¤ºä¾‹æ—¥å¿—

### æ­£å¸¸è¿è¡Œ

```
[2025-12-26 14:30:00] INFO: ============================================================
[2025-12-26 14:30:00] INFO: Photo Gallery Application Started
[2025-12-26 14:30:00] INFO: ============================================================
[2025-12-26 14:30:15] INFO: è®¿é—®ä¸»é¡µ
[2025-12-26 14:30:16] INFO: API: è¯·æ±‚ç…§ç‰‡åˆ—è¡¨
[2025-12-26 14:30:16] INFO: åŠ è½½å…ƒæ•°æ®: 5 å¼ ç…§ç‰‡
[2025-12-26 14:30:16] INFO: API: è¿”å› 5 å¼ ç…§ç‰‡
```

### ä¸Šä¼ ç…§ç‰‡

```
[2025-12-26 14:35:20] INFO: API: æ”¶åˆ°ä¸Šä¼ è¯·æ±‚
[2025-12-26 14:35:20] INFO: ä¿å­˜æ–‡ä»¶: sunset.jpg -> a1b2c3d4.jpg
[2025-12-26 14:35:20] INFO: ä¿å­˜å…ƒæ•°æ®: 6 å¼ ç…§ç‰‡
[2025-12-26 14:35:20] INFO: ä¸Šä¼ æˆåŠŸ: a1b2c3d4.jpg
```

### å‘ç”Ÿé”™è¯¯

```
[2025-12-26 14:40:30] ERROR: ä¸Šä¼ å¤±è´¥: [Errno 28] No space left on device
[2025-12-26 14:40:30] ERROR: Traceback (most recent call last):
[2025-12-26 14:40:30] ERROR:   File "app.py", line 123, in upload_photo
[2025-12-26 14:40:30] ERROR:     file.save(filepath)
```

---

**æ—¥å¿—æ˜¯æ’æŸ¥é—®é¢˜çš„æœ€ä½³å·¥å…·ï¼** ğŸ“âœ¨

